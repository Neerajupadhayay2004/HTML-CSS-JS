<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced AI Password Strength Checker</title>
    <style>
        :root {
            --weak: #e74c3c;
            --fair: #f39c12;
            --good: #3498db;
            --strong: #2ecc71;
            --excellent: #27ae60;
            --text-dark: #2c3e50;
            --text-medium: #34495e;
            --text-light: #7f8c8d;
            --bg-light: #f8f9fa;
            --border: #e0e0e0;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            color: var(--text-medium);
        }
        
        .container {
            background-color: white;
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 30px;
            width: 100%;
            max-width: 550px;
            transition: all 0.3s ease;
        }
        
        h1 {
            color: var(--text-dark);
            text-align: center;
            margin-bottom: 30px;
            font-weight: 600;
            font-size: 28px;
        }
        
        .password-container {
            position: relative;
            margin-bottom: 25px;
        }
        
        input[type="password"], input[type="text"] {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
        }
        
        input[type="password"]:focus, input[type="text"]:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .toggle-password {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: var(--text-light);
            background: none;
            border: none;
            font-size: 18px;
        }
        
        .strength-meter {
            height: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
            margin-bottom: 20px;
            overflow: hidden;
            position: relative;
        }
        
        .strength-bar {
            height: 100%;
            width: 0;
            transition: width 0.5s ease, background-color 0.5s ease;
            border-radius: 5px;
        }
        
        .strength-text {
            font-weight: 600;
            text-align: center;
            margin-bottom: 20px;
            font-size: 18px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .strength-icon {
            margin-right: 8px;
            font-size: 20px;
        }
        
        .requirements {
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .requirement {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            color: var(--text-light);
            font-size: 14px;
        }
        
        .requirement.fulfilled {
            color: var(--excellent);
        }
        
        .requirement-icon {
            margin-right: 10px;
            font-size: 16px;
            min-width: 16px;
        }
        
        .ai-section {
            background-color: var(--bg-light);
            border-radius: 8px;
            padding: 20px;
            margin-top: 25px;
            border-left: 4px solid #3498db;
            transition: all 0.3s ease;
        }
        
        .ai-section h3 {
            margin-top: 0;
            color: var(--text-dark);
            font-size: 16px;
            display: flex;
            align-items: center;
        }
        
        .ai-icon {
            margin-right: 8px;
            color: #3498db;
        }
        
        .ai-section ul {
            padding-left: 20px;
            margin-bottom: 0;
        }
        
        .ai-section li {
            margin-bottom: 8px;
            color: var(--text-medium);
            font-size: 14px;
        }
        
        .hidden {
            display: none;
        }
        
        .time-to-crack {
            font-style: italic;
            text-align: center;
            color: var(--text-light);
            margin: 15px 0;
            font-size: 14px;
        }
        
        .password-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            gap: 10px;
        }
        
        .btn {
            padding: 10px 15px;
            border-radius: 6px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }
        
        .btn-primary {
            background-color: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
        }
        
        .btn-secondary {
            background-color: #ecf0f1;
            color: var(--text-dark);
        }
        
        .btn-secondary:hover {
            background-color: #d5dbdb;
        }
        
        .btn-warning {
            background-color: #f39c12;
            color: white;
        }
        
        .btn-warning:hover {
            background-color: #d68910;
        }
        
        .btn-icon {
            margin-right: 6px;
        }
        
        .password-history {
            margin-top: 20px;
            border-top: 1px solid var(--border);
            padding-top: 15px;
        }
        
        .history-title {
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            color: var(--text-dark);
        }
        
        .history-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dashed var(--border);
        }
        
        .history-password {
            font-family: 'Courier New', monospace;
            letter-spacing: 1px;
        }
        
        .history-strength {
            font-weight: 600;
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 10px;
            background-color: #ecf0f1;
        }
        
        .strength-weak {
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--weak);
        }
        
        .strength-fair {
            background-color: rgba(243, 156, 18, 0.1);
            color: var(--fair);
        }
        
        .strength-good {
            background-color: rgba(52, 152, 219, 0.1);
            color: var(--good);
        }
        
        .strength-strong {
            background-color: rgba(46, 204, 113, 0.1);
            color: var(--strong);
        }
        
        .auto-correct {
            margin-top: 15px;
            padding: 12px;
            background-color: #f0f8ff;
            border-radius: 6px;
            border: 1px dashed #3498db;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .corrected-password {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: var(--text-dark);
        }
        
        .apply-correction {
            background: none;
            border: none;
            color: #3498db;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            font-size: 13px;
        }
        
        .apply-correction:hover {
            text-decoration: underline;
        }
        
        .password-complexity {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            font-size: 13px;
        }
        
        .complexity-bar {
            height: 6px;
            background-color: #ecf0f1;
            border-radius: 3px;
            flex-grow: 1;
            margin: 0 10px;
            align-self: center;
        }
        
        .complexity-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.5s ease;
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            
            .requirements {
                grid-template-columns: 1fr;
            }
            
            .password-actions {
                flex-direction: column;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="container">
        <h1>Advanced AI Password Strength Analyzer</h1>
        
        <div class="password-container">
            <input type="password" id="passwordInput" placeholder="Enter your password" autocomplete="off" spellcheck="false">
            <button class="toggle-password" id="togglePassword" aria-label="Toggle password visibility">
                <i class="fas fa-eye"></i>
            </button>
        </div>
        
        <div class="password-complexity">
            <span>Complexity</span>
            <div class="complexity-bar">
                <div class="complexity-fill" id="complexityBar"></div>
            </div>
            <span id="complexityText">Low</span>
        </div>
        
        <div class="strength-meter">
            <div class="strength-bar" id="strengthBar"></div>
        </div>
        
        <div class="strength-text" id="strengthText">
            <i class="fas fa-shield-alt strength-icon"></i>
            <span>Password Strength</span>
        </div>
        
        <div class="time-to-crack" id="timeToCrack"></div>
        
        <div class="requirements">
            <div class="requirement" id="lengthReq">
                <span class="requirement-icon"><i class="far fa-circle"></i></span>
                <span>At least 12 characters</span>
            </div>
            <div class="requirement" id="lowercaseReq">
                <span class="requirement-icon"><i class="far fa-circle"></i></span>
                <span>Lowercase letters (a-z)</span>
            </div>
            <div class="requirement" id="uppercaseReq">
                <span class="requirement-icon"><i class="far fa-circle"></i></span>
                <span>Uppercase letters (A-Z)</span>
            </div>
            <div class="requirement" id="numberReq">
                <span class="requirement-icon"><i class="far fa-circle"></i></span>
                <span>Numbers (0-9)</span>
            </div>
            <div class="requirement" id="specialReq">
                <span class="requirement-icon"><i class="far fa-circle"></i></span>
                <span>Special characters (!@#)</span>
            </div>
            <div class="requirement" id="uniqueReq">
                <span class="requirement-icon"><i class="far fa-circle"></i></span>
                <span>No repeated patterns</span>
            </div>
        </div>
        
        <div class="auto-correct hidden" id="autoCorrect">
            <div>
                <span>AI Suggestion: </span>
                <span class="corrected-password" id="correctedPassword"></span>
            </div>
            <button class="apply-correction" id="applyCorrection">
                <i class="fas fa-magic btn-icon"></i>
                Apply
            </button>
        </div>
        
        <div class="ai-section hidden" id="aiSuggestions">
            <h3><i class="fas fa-robot ai-icon"></i> AI Recommendations:</h3>
            <ul id="suggestionsList">
                <!-- Suggestions will be added here by JavaScript -->
            </ul>
        </div>
        
        <div class="password-actions">
            <button class="btn btn-secondary" id="generatePassword">
                <i class="fas fa-key btn-icon"></i>
                Generate Strong Password
            </button>
            <button class="btn btn-warning" id="refreshButton">
                <i class="fas fa-sync-alt btn-icon"></i>
                Refresh
            </button>
            <button class="btn btn-primary" id="savePassword">
                <i class="fas fa-save btn-icon"></i>
                Save for Comparison
            </button>
        </div>
        
        <div class="password-history hidden" id="passwordHistory">
            <div class="history-title">
                <i class="fas fa-history btn-icon"></i>
                Password History
            </div>
            <div id="historyItems"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const passwordInput = document.getElementById('passwordInput');
            const togglePassword = document.getElementById('togglePassword');
            const strengthBar = document.getElementById('strengthBar');
            const strengthText = document.getElementById('strengthText');
            const strengthIcon = strengthText.querySelector('.strength-icon');
            const timeToCrack = document.getElementById('timeToCrack');
            const aiSuggestions = document.getElementById('aiSuggestions');
            const suggestionsList = document.getElementById('suggestionsList');
            const autoCorrect = document.getElementById('autoCorrect');
            const correctedPassword = document.getElementById('correctedPassword');
            const applyCorrection = document.getElementById('applyCorrection');
            const generatePasswordBtn = document.getElementById('generatePassword');
            const refreshButton = document.getElementById('refreshButton');
            const savePasswordBtn = document.getElementById('savePassword');
            const passwordHistory = document.getElementById('passwordHistory');
            const historyItems = document.getElementById('historyItems');
            const complexityBar = document.getElementById('complexityBar');
            const complexityText = document.getElementById('complexityText');
            
            // Requirements
            const lengthReq = document.getElementById('lengthReq');
            const lowercaseReq = document.getElementById('lowercaseReq');
            const uppercaseReq = document.getElementById('uppercaseReq');
            const numberReq = document.getElementById('numberReq');
            const specialReq = document.getElementById('specialReq');
            const uniqueReq = document.getElementById('uniqueReq');
            
            // Password history
            let savedPasswords = JSON.parse(localStorage.getItem('passwordHistory')) || [];
            
            // Initialize
            updatePasswordHistory();
            
            // Toggle password visibility
            togglePassword.addEventListener('click', function() {
                const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                passwordInput.setAttribute('type', type);
                this.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
            });
            
            // Analyze password as user types
            passwordInput.addEventListener('input', function() {
                const password = this.value;
                analyzePassword(password);
            });
            
            // Apply auto-correction
            applyCorrection.addEventListener('click', function() {
                passwordInput.value = correctedPassword.textContent;
                passwordInput.dispatchEvent(new Event('input'));
            });
            
            // Generate strong password
            generatePasswordBtn.addEventListener('click', function() {
                const password = generateStrongPassword();
                passwordInput.value = password;
                passwordInput.type = 'text';
                togglePassword.innerHTML = '<i class="fas fa-eye-slash"></i>';
                analyzePassword(password);
            });
            
            // Refresh button
            refreshButton.addEventListener('click', function() {
                // Reset password input
                passwordInput.value = '';
                passwordInput.type = 'password';
                togglePassword.innerHTML = '<i class="fas fa-eye"></i>';
                
                // Reset all indicators
                strengthBar.style.width = '0%';
                strengthText.querySelector('span').textContent = 'Password Strength';
                strengthText.style.color = 'var(--text-dark)';
                strengthIcon.className = 'fas fa-shield-alt strength-icon';
                
                // Reset complexity
                complexityBar.style.width = '0%';
                complexityText.textContent = 'Low';
                complexityText.style.color = 'var(--text-light)';
                
                // Reset requirements
                resetRequirements();
                
                // Hide AI suggestions and auto-correct
                aiSuggestions.classList.add('hidden');
                autoCorrect.classList.add('hidden');
                
                // Clear time to crack
                timeToCrack.textContent = '';
                
                // Focus back on input
                passwordInput.focus();
            });
            
            // Save password for comparison
            savePasswordBtn.addEventListener('click', function() {
                const password = passwordInput.value;
                if (password.length === 0) return;
                
                const strength = calculatePasswordStrength(password);
                
                // Add to history (limit to 5)
                savedPasswords.unshift({
                    password: password,
                    strength: strength.score,
                    timestamp: new Date().toISOString()
                });
                
                if (savedPasswords.length > 5) {
                    savedPasswords = savedPasswords.slice(0, 5);
                }
                
                localStorage.setItem('passwordHistory', JSON.stringify(savedPasswords));
                updatePasswordHistory();
                
                // Show notification
                const originalText = savePasswordBtn.innerHTML;
                savePasswordBtn.innerHTML = '<i class="fas fa-check btn-icon"></i> Saved!';
                setTimeout(() => {
                    savePasswordBtn.innerHTML = originalText;
                }, 2000);
            });
            
            function updatePasswordHistory() {
                if (savedPasswords.length === 0) {
                    passwordHistory.classList.add('hidden');
                    return;
                }
                
                passwordHistory.classList.remove('hidden');
                historyItems.innerHTML = '';
                
                savedPasswords.forEach(item => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    
                    const passwordSpan = document.createElement('span');
                    passwordSpan.className = 'history-password';
                    passwordSpan.textContent = maskPassword(item.password);
                    
                    const strengthSpan = document.createElement('span');
                    strengthSpan.className = 'history-strength ' + getStrengthClass(item.strength);
                    strengthSpan.textContent = getStrengthLabel(item.strength);
                    
                    historyItem.appendChild(passwordSpan);
                    historyItem.appendChild(strengthSpan);
                    historyItems.appendChild(historyItem);
                    
                    // Add click to fill functionality
                    historyItem.addEventListener('click', function() {
                        passwordInput.value = item.password;
                        passwordInput.type = 'text';
                        togglePassword.innerHTML = '<i class="fas fa-eye-slash"></i>';
                        analyzePassword(item.password);
                    });
                });
            }
            
            function maskPassword(password) {
                if (password.length <= 4) {
                    return password.charAt(0) + '*'.repeat(password.length - 1);
                }
                return password.substring(0, 2) + '*'.repeat(password.length - 4) + password.substring(password.length - 2);
            }
            
            function getStrengthClass(score) {
                if (score < 30) return 'strength-weak';
                if (score < 60) return 'strength-fair';
                if (score < 80) return 'strength-good';
                return 'strength-strong';
            }
            
            function getStrengthLabel(score) {
                if (score < 30) return 'Weak';
                if (score < 60) return 'Fair';
                if (score < 80) return 'Good';
                return 'Strong';
            }
            
            function analyzePassword(password) {
                // Reset requirements
                resetRequirements();
                
                // Calculate password strength
                const strength = calculatePasswordStrength(password);
                
                // Update strength meter
                updateStrengthMeter(strength.score, strength.messages);
                
                // Update complexity
                updateComplexity(strength.complexity);
                
                // Update requirements
                updateRequirements(password, strength);
                
                // Calculate and display time to crack
                displayTimeToCrack(password, strength.entropy);
                
                // Provide AI suggestions if password is weak
                if (strength.score < 80) {
                    provideAISuggestions(password, strength);
                    aiSuggestions.classList.remove('hidden');
                } else {
                    aiSuggestions.classList.add('hidden');
                }
                
                // Provide auto-correction if possible
                if (strength.score < 70 && strength.autoCorrect) {
                    correctedPassword.textContent = strength.autoCorrect;
                    autoCorrect.classList.remove('hidden');
                } else {
                    autoCorrect.classList.add('hidden');
                }
            }
            
            function resetRequirements() {
                const requirements = [lengthReq, lowercaseReq, uppercaseReq, numberReq, specialReq, uniqueReq];
                requirements.forEach(req => {
                    req.classList.remove('fulfilled');
                    req.querySelector('.requirement-icon').innerHTML = '<i class="far fa-circle"></i>';
                });
            }
            
            function calculatePasswordStrength(password) {
                let score = 0;
                const messages = [];
                let entropy = 0;
                let complexity = 0;
                let autoCorrect = null;
                
                // Length
                if (password.length === 0) {
                    return { 
                        score: 0, 
                        messages: ['Enter a password to analyze'], 
                        entropy: 0,
                        complexity: 0
                    };
                }
                
                // Length score
                if (password.length < 4) {
                    score += 5;
                    messages.push('Very short password');
                    autoCorrect = generatePasswordAddition(password, 12 - password.length);
                } else if (password.length < 8) {
                    score += 15;
                    messages.push('Short password');
                    autoCorrect = generatePasswordAddition(password, 12 - password.length);
                } else if (password.length < 12) {
                    score += 30;
                    messages.push('Medium length password');
                    autoCorrect = generatePasswordAddition(password, 12 - password.length);
                } else if (password.length < 16) {
                    score += 50;
                    messages.push('Good length password');
                } else {
                    score += 70;
                    messages.push('Long password - excellent!');
                }
                
                // Character variety
                const hasLowercase = /[a-z]/.test(password);
                const hasUppercase = /[A-Z]/.test(password);
                const hasNumbers = /[0-9]/.test(password);
                const hasSpecial = /[^a-zA-Z0-9]/.test(password);
                
                let varietyCount = 0;
                if (hasLowercase) varietyCount++;
                if (hasUppercase) varietyCount++;
                if (hasNumbers) varietyCount++;
                if (hasSpecial) varietyCount++;
                
                // Add points for character variety
                if (varietyCount >= 4) {
                    score += 30;
                    messages.push('Excellent character variety');
                    complexity = 100;
                } else if (varietyCount === 3) {
                    score += 20;
                    messages.push('Good character variety');
                    complexity = 75;
                    autoCorrect = autoCorrect || addMissingCharacterType(password, hasLowercase, hasUppercase, hasNumbers, hasSpecial);
                } else if (varietyCount === 2) {
                    score += 10;
                    messages.push('Fair character variety');
                    complexity = 50;
                    autoCorrect = autoCorrect || addMissingCharacterType(password, hasLowercase, hasUppercase, hasNumbers, hasSpecial);
                } else {
                    messages.push('Poor character variety');
                    complexity = 25;
                    autoCorrect = autoCorrect || addMissingCharacterType(password, hasLowercase, hasUppercase, hasNumbers, hasSpecial);
                }
                
                // Entropy calculation
                let poolSize = 0;
                if (hasLowercase) poolSize += 26;
                if (hasUppercase) poolSize += 26;
                if (hasNumbers) poolSize += 10;
                if (hasSpecial) poolSize += 32; // Approximate common special chars
                
                entropy = Math.log2(Math.pow(poolSize, password.length));
                
                // Common password penalty
                const commonPasswords = ['password', '123456', '12345678', 'qwerty', 'abc123', 'password1', 'admin', 'welcome', 'sunshine', 'letmein'];
                if (commonPasswords.includes(password.toLowerCase())) {
                    score = Math.max(score - 40, 5);
                    messages.push('This is an extremely common password');
                    autoCorrect = generateStrongPassword();
                }
                
                // Sequential characters penalty
                const sequentialRegex = /(?:123|234|345|456|567|678|789|890|abc|bcd|cde|def|efg|fgh|ghi|hij|ijk|jkl|klm|lmn|mno|nop|opq|pqr|qrs|rst|stu|tuv|uvw|vwx|wxy|xyz|012|123|234|345|456|567|678|789)/i;
                if (sequentialRegex.test(password)) {
                    score = Math.max(score - 20, 0);
                    messages.push('Sequential characters make passwords weaker');
                    autoCorrect = autoCorrect || fixSequentialChars(password);
                }
                
                // Repeated characters penalty
                const repeatRegex = /(.)\1{2,}/;
                if (repeatRegex.test(password)) {
                    score = Math.max(score - 15, 0);
                    messages.push('Repeated characters make passwords weaker');
                    autoCorrect = autoCorrect || fixRepeatedChars(password);
                }
                
                // Dictionary words penalty
                const dictionaryWords = ['password', 'letmein', 'welcome', 'sunshine', 'monkey', 'dragon', 'football', 'iloveyou', 'princess', 'master', 'hello'];
                const lowerPassword = password.toLowerCase();
                for (const word of dictionaryWords) {
                    if (lowerPassword.includes(word)) {
                        score = Math.max(score - 25, 0);
                        messages.push('Avoid common dictionary words');
                        autoCorrect = autoCorrect || replaceDictionaryWord(password, word);
                        break;
                    }
                }
                
                // Keyboard patterns penalty
                const keyboardPatterns = ['qwerty', 'asdfgh', 'zxcvbn', '1qaz2wsx', '1q2w3e4r'];
                for (const pattern of keyboardPatterns) {
                    if (lowerPassword.includes(pattern)) {
                        score = Math.max(score - 20, 0);
                        messages.push('Avoid keyboard patterns');
                        autoCorrect = autoCorrect || replaceKeyboardPattern(password, pattern);
                        break;
                    }
                }
                
                // Unique characters check
                const uniqueChars = new Set(password.split(''));
                if (uniqueChars.size < password.length / 2) {
                    score = Math.max(score - 10, 0);
                    messages.push('Too many repeated characters');
                    autoCorrect = autoCorrect || increaseCharacterVariety(password);
                }
                
                // Cap score at 100
                score = Math.min(score, 100);
                
                return { 
                    score, 
                    messages, 
                    entropy,
                    complexity,
                    hasLowercase, 
                    hasUppercase, 
                    hasNumbers, 
                    hasSpecial,
                    autoCorrect
                };
            }
            
            function updateStrengthMeter(score, messages) {
                // Update bar
                strengthBar.style.width = `${score}%`;
                
                // Update color based on score
                let strengthLabel, strengthColor, strengthIconClass;
                
                if (score < 30) {
                    strengthColor = 'var(--weak)';
                    strengthLabel = 'Very Weak';
                    strengthIconClass = 'fas fa-exclamation-triangle';
                } else if (score < 60) {
                    strengthColor = 'var(--fair)';
                    strengthLabel = 'Fair';
                    strengthIconClass = 'fas fa-exclamation-circle';
                } else if (score < 80) {
                    strengthColor = 'var(--good)';
                    strengthLabel = 'Good';
                    strengthIconClass = 'fas fa-shield-alt';
                } else {
                    strengthColor = 'var(--strong)';
                    strengthLabel = 'Strong';
                    strengthIconClass = 'fas fa-shield-alt';
                }
                
                strengthBar.style.backgroundColor = strengthColor;
                strengthText.querySelector('span').textContent = strengthLabel;
                strengthText.style.color = strengthColor;
                
                // Update icon
                strengthIcon.className = strengthIconClass + ' strength-icon';
                
                // Show first message as tooltip
                strengthText.title = messages.join('\n');
            }
            
            function updateComplexity(complexity) {
                complexityBar.style.width = `${complexity}%`;
                
                if (complexity < 30) {
                    complexityBar.style.backgroundColor = 'var(--weak)';
                    complexityText.textContent = 'Low';
                    complexityText.style.color = 'var(--weak)';
                } else if (complexity < 60) {
                    complexityBar.style.backgroundColor = 'var(--fair)';
                    complexityText.textContent = 'Medium';
                    complexityText.style.color = 'var(--fair)';
                } else if (complexity < 80) {
                    complexityBar.style.backgroundColor = 'var(--good)';
                    complexityText.textContent = 'High';
                    complexityText.style.color = 'var(--good)';
                } else {
                    complexityBar.style.backgroundColor = 'var(--excellent)';
                    complexityText.textContent = 'Excellent';
                    complexityText.style.color = 'var(--excellent)';
                }
            }
            
            function updateRequirements(password, strength) {
                // Length
                if (password.length >= 12) {
                    lengthReq.classList.add('fulfilled');
                    lengthReq.querySelector('.requirement-icon').innerHTML = '<i class="fas fa-check-circle"></i>';
                }
                
                // Lowercase
                if (strength.hasLowercase) {
                    lowercaseReq.classList.add('fulfilled');
                    lowercaseReq.querySelector('.requirement-icon').innerHTML = '<i class="fas fa-check-circle"></i>';
                }
                
                // Uppercase
                if (strength.hasUppercase) {
                    uppercaseReq.classList.add('fulfilled');
                    uppercaseReq.querySelector('.requirement-icon').innerHTML = '<i class="fas fa-check-circle"></i>';
                }
                
                // Numbers
                if (strength.hasNumbers) {
                    numberReq.classList.add('fulfilled');
                    numberReq.querySelector('.requirement-icon').innerHTML = '<i class="fas fa-check-circle"></i>';
                }
                
                // Special characters
                if (strength.hasSpecial) {
                    specialReq.classList.add('fulfilled');
                    specialReq.querySelector('.requirement-icon').innerHTML = '<i class="fas fa-check-circle"></i>';
                }
                
                // Unique characters
                const uniqueChars = new Set(password.split(''));
                if (uniqueChars.size >= password.length * 0.7) { // At least 70% unique chars
                    uniqueReq.classList.add('fulfilled');
                    uniqueReq.querySelector('.requirement-icon').innerHTML = '<i class="fas fa-check-circle"></i>';
                }
            }
            
            function displayTimeToCrack(password, entropy) {
                if (password.length === 0) {
                    timeToCrack.textContent = '';
                    return;
                }
                
                // Very simplified estimation (for demonstration)
                const guessesPerSecond = 1e9; // 1 billion guesses per second (modern GPU)
                const secondsToCrack = Math.pow(2, entropy) / guessesPerSecond;
                
                let timeText;
                
                if (secondsToCrack < 1) {
                    timeText = 'Instantly';
                } else if (secondsToCrack < 60) {
                    timeText = 'Less than a minute';
                } else if (secondsToCrack < 3600) {
                    const minutes = Math.floor(secondsToCrack / 60);
                    timeText = `${minutes} minute${minutes > 1 ? 's' : ''}`;
                } else if (secondsToCrack < 86400) {
                    const hours = Math.floor(secondsToCrack / 3600);
                    timeText = `${hours} hour${hours > 1 ? 's' : ''}`;
                } else if (secondsToCrack < 31536000) {
                    const days = Math.floor(secondsToCrack / 86400);
                    timeText = `${days} day${days > 1 ? 's' : ''}`;
                } else if (secondsToCrack < 3153600000) {
                    const years = Math.floor(secondsToCrack / 31536000);
                    timeText = `${years} year${years > 1 ? 's' : ''}`;
                } else if (secondsToCrack < 31536000000) {
                    timeText = 'Decades';
                } else if (secondsToCrack < 315360000000) {
                    timeText = 'Centuries';
                } else {
                    timeText = 'Millennia';
                }
                
                timeToCrack.textContent = `Estimated time to crack: ${timeText}`;
            }
            
            function provideAISuggestions(password, strength) {
                suggestionsList.innerHTML = '';
                const suggestions = [];
                
                // Length suggestions
                if (password.length < 12) {
                    suggestions.push(`Increase length to at least 12 characters (currently ${password.length})`);
                }
                
                // Character variety suggestions
                if (!strength.hasLowercase) {
                    suggestions.push('Add lowercase letters (a-z) for better variety');
                }
                
                if (!strength.hasUppercase) {
                    suggestions.push('Add uppercase letters (A-Z) for better variety');
                }
                
                if (!strength.hasNumbers) {
                    suggestions.push('Include numbers (0-9) to increase complexity');
                }
                
                if (!strength.hasSpecial) {
                    suggestions.push('Add special characters (!@#$%^&*) to maximize security');
                }
                
                // Common patterns suggestions
                if (/^\d+$/.test(password)) {
                    suggestions.push('Avoid using only numbers - mix character types');
                }
                
                if (/^[a-zA-Z]+$/.test(password)) {
                    suggestions.push('Avoid using only letters - include numbers and symbols');
                }
                
                if (password === password.toLowerCase()) {
                    suggestions.push('Mix uppercase and lowercase letters for better security');
                }
                
                if (password === password.toUpperCase()) {
                    suggestions.push('Mix uppercase and lowercase letters for better security');
                }
                
                // Common password suggestions
                const commonPasswords = ['password', '123456', '12345678', 'qwerty', 'abc123'];
                if (commonPasswords.includes(password.toLowerCase())) {
                    suggestions.push('This is an extremely common password - choose something more unique');
                }
                
                // Sequential characters
                const sequentialRegex = /(?:123|234|345|456|567|678|789|890|abc|bcd|cde|def|efg|fgh|ghi|hij|ijk|jkl|klm|lmn|mno|nop|opq|pqr|qrs|rst|stu|tuv|uvw|vwx|wxy|xyz)/i;
                if (sequentialRegex.test(password)) {
                    suggestions.push('Avoid sequential characters (like "123" or "abc") which are easy to guess');
                }
                
                // Repeated characters
                const repeatRegex = /(.)\1{2,}/;
                if (repeatRegex.test(password)) {
                    suggestions.push('Avoid repeated characters (like "aaa" or "111") which reduce security');
                }
                
                // Dictionary words
                const dictionaryWords = ['password', 'letmein', 'welcome', 'sunshine', 'monkey', 'dragon', 'football', 'iloveyou'];
                const lowerPassword = password.toLowerCase();
                for (const word of dictionaryWords) {
                    if (lowerPassword.includes(word)) {
                        suggestions.push('Avoid common dictionary words which are vulnerable to dictionary attacks');
                        break;
                    }
                }
                
                // Keyboard patterns
                const keyboardPatterns = ['qwerty', 'asdfgh', 'zxcvbn', '1qaz2wsx', '1q2w3e4r'];
                for (const pattern of keyboardPatterns) {
                    if (lowerPassword.includes(pattern)) {
                        suggestions.push('Avoid keyboard patterns which are easy to guess');
                        break;
                    }
                }
                
                // Unique characters
                const uniqueChars = new Set(password.split(''));
                if (uniqueChars.size < password.length / 2) {
                    suggestions.push('Use more unique characters - too many repeats reduce security');
                }
                
                // If no specific suggestions, provide general advice
                if (suggestions.length === 0) {
                    suggestions.push('Consider making your password longer for added security');
                    suggestions.push('Try using a passphrase (multiple random words) for better memorability and security');
                }
                
                // Add advanced suggestions
                suggestions.push('Consider using a password manager to generate and store strong, unique passwords');
                suggestions.push('Enable two-factor authentication wherever possible for added security');
                
                // Add suggestions to the list
                suggestions.forEach(suggestion => {
                    const li = document.createElement('li');
                    li.textContent = suggestion;
                    suggestionsList.appendChild(li);
                });
            }
            
            // Password generation and correction functions
            function generateStrongPassword(length = 16) {
                const chars = {
                    lowercase: 'abcdefghijklmnopqrstuvwxyz',
                    uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
                    numbers: '0123456789',
                    special: '!@#$%^&*()_+-=[]{}|;:,.<>?'
                };
                
                let allChars = chars.lowercase + chars.uppercase + chars.numbers + chars.special;
                let password = '';
                
                // Ensure at least one character from each set
                password += getRandomChar(chars.lowercase);
                password += getRandomChar(chars.uppercase);
                password += getRandomChar(chars.numbers);
                password += getRandomChar(chars.special);
                
                // Fill the rest randomly
                for (let i = 4; i < length; i++) {
                    password += getRandomChar(allChars);
                }
                
                // Shuffle the password
                return shuffleString(password);
            }
            
            function getRandomChar(charSet) {
                return charSet[Math.floor(Math.random() * charSet.length)];
            }
            
            function shuffleString(str) {
                const array = str.split('');
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array.join('');
            }
            
            function generatePasswordAddition(password, count) {
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*';
                let addition = '';
                
                for (let i = 0; i < count; i++) {
                    addition += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                
                return password + addition;
            }
            
            function addMissingCharacterType(password, hasLower, hasUpper, hasNum, hasSpecial) {
                let additions = '';
                
                if (!hasLower) additions += 'a';
                if (!hasUpper) additions += 'A';
                if (!hasNum) additions += '1';
                if (!hasSpecial) additions += '!';
                
                // Insert at random position
                const pos = Math.floor(Math.random() * password.length);
                return password.slice(0, pos) + additions + password.slice(pos);
            }
            
            function fixSequentialChars(password) {
                // Replace sequential numbers with random numbers
                let fixed = password.replace(/(123|234|345|456|567|678|789|890)/g, match => {
                    return Math.floor(100 + Math.random() * 900).toString().substring(0, match.length);
                });
                
                // Replace sequential letters with random letters
                fixed = fixed.replace(/(abc|bcd|cde|def|efg|fgh|ghi|hij|ijk|jkl|klm|lmn|mno|nop|opq|pqr|qrs|rst|stu|tuv|uvw|vwx|wxy|xyz)/gi, match => {
                    const start = Math.floor(Math.random() * 23); // 26 letters - 3 length
                    return 'abcdefghijklmnopqrstuvwxyz'.substring(start, start + match.length);
                });
                
                return fixed === password ? null : fixed;
            }
            
            function fixRepeatedChars(password) {
                return password.replace(/(.)\1{2,}/g, match => {
                    // Replace repeats with similar but varied characters
                    const char = match[0];
                    let replacement = char;
                    
                    // Alternate between similar characters
                    const similarChars = {
                        'a': 'aA4@',
                        'b': 'bB68',
                        'c': 'cC(<',
                        'd': 'dD)',
                        'e': 'eE3#',
                        'f': 'fF/',
                        'g': 'gG9',
                        'h': 'hH#',
                        'i': 'iI1!|',
                        'j': 'jJ',
                        'k': 'kK<',
                        'l': 'lL1|',
                        'm': 'mM',
                        'n': 'nN',
                        'o': 'oO0*',
                        'p': 'pP',
                        'q': 'qQ',
                        'r': 'rR',
                        's': 'sS5$',
                        't': 'tT+7',
                        'u': 'uU',
                        'v': 'vV',
                        'w': 'wW',
                        'x': 'xX*',
                        'y': 'yY',
                        'z': 'zZ2',
                        '0': '0oO*',
                        '1': '1iI|',
                        '2': '2zZ',
                        '3': '3eE#',
                        '4': '4aA$',
                        '5': '5sS%',
                        '6': '6bG',
                        '7': '7tT',
                        '8': '8B',
                        '9': '9gG'
                    };
                    
                    if (similarChars[char.toLowerCase()]) {
                        const options = similarChars[char.toLowerCase()];
                        for (let i = 1; i < match.length; i++) {
                            replacement += options[Math.floor(Math.random() * options.length)];
                        }
                        return replacement;
                    }
                    
                    // Default: just add numbers
                    for (let i = 1; i < match.length; i++) {
                        replacement += Math.floor(Math.random() * 10);
                    }
                    return replacement;
                });
            }
            
            function replaceDictionaryWord(password, word) {
                const index = password.toLowerCase().indexOf(word);
                if (index === -1) return null;
                
                const before = password.substring(0, index);
                const after = password.substring(index + word.length);
                const replacement = generateStrongPassword(word.length);
                
                return before + replacement + after;
            }
            
            function replaceKeyboardPattern(password, pattern) {
                const index = password.toLowerCase().indexOf(pattern);
                if (index === -1) return null;
                
                const before = password.substring(0, index);
                const after = password.substring(index + pattern.length);
                const replacement = generateStrongPassword(pattern.length);
                
                return before + replacement + after;
            }
            
            function increaseCharacterVariety(password) {
                // Replace some repeated characters with new ones
                const charCount = {};
                for (const char of password) {
                    charCount[char] = (charCount[char] || 0) + 1;
                }
                
                // Find most repeated characters
                const sortedChars = Object.keys(charCount).sort((a, b) => charCount[b] - charCount[a]);
                
                // Replace some of the most repeated
                let newPassword = password;
                for (let i = 0; i < Math.min(2, sortedChars.length); i++) {
                    const char = sortedChars[i];
                    const regex = new RegExp(char, 'g');
                    const matches = password.match(regex);
                    if (matches && matches.length > 2) {
                        // Replace half of them
                        const replaceCount = Math.floor(matches.length / 2);
                        let replaced = 0;
                        newPassword = newPassword.replace(regex, m => {
                            if (replaced < replaceCount) {
                                replaced++;
                                return getRandomChar('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*');
                            }
                            return m;
                        });
                    }
                }
                
                return newPassword === password ? null : newPassword;
            }
        });
    </script>
</body>
</html>